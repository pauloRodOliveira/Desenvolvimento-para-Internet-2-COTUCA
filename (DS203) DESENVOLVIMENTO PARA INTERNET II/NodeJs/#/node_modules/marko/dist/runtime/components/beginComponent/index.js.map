{"version":3,"sources":["../../../../src/runtime/components/beginComponent/index.js"],"names":["ComponentDef","require","FLAG_WILL_RERENDER_IN_BROWSER","module","exports","beginComponent","componentsContext","component","key","ownerComponentDef","isSplitComponent","isImplicitComponent","componentId","id","componentDef","ownerIsRenderBoundary","ownerWillRerender","_wrr","push","out","runtimeId","global","noBrowserRerender","w"],"mappings":"AAAA;;AAEA,MAAMA,YAAY,GAAGC,OAAO,CAAC,iBAAD,CAA5B;;AAEA,IAAIC,6BAA6B,GAAG,CAApC;AACA;;AAEAC,MAAM,CAACC,OAAP,GAAiB,SAASC,cAAT;AACfC,iBADe;AAEfC,SAFe;AAGfC,GAHe;AAIfC,iBAJe;AAKfC,gBALe;AAMfC,mBANe;AAOf;AACA,MAAIC,WAAW,GAAGL,SAAS,CAACM,EAA5B;;AAEA,MAAIC,YAAY,GAAIR,iBAAiB,GAAjB,GAAoC,IAAIN,YAAJ;AACtDO,EAAAA,SADsD;AAEtDK,EAAAA,WAFsD;AAGtDN,EAAAA,iBAHsD,CAAxD;;;AAMA,MAAIS,qBAAqB;AACvBN,EAAAA,iBAAiB,IAAIA,iBAAiB,IADxC;AAEA,MAAIO,iBAAiB;AACnBP,EAAAA,iBAAiB;AACjBA,EAAAA,iBAAiB,IAAjB,GAA6BP,6BAF/B;AAGA;AACA,MAAI,CAACI,iBAAiB,GAAlB,IAAqCU,iBAAzC,EAA4D;AAC1DF,IAAAA,YAAY,IAAZ,IAAyBZ,6BAAzB;AACAY,IAAAA,YAAY,CAACG,IAAb,GAAoB,IAApB;AACA,WAAOH,YAAP;AACD;;AAED,MAAIH,mBAAmB,KAAK,IAA5B,EAAkC;AAChC;AACA;AACA;AACA,WAAOG,YAAP;AACD;;AAEDR,EAAAA,iBAAiB,GAAjB,CAAgCY,IAAhC,CAAqCJ,YAArC;;AAEA,MAAIK,GAAG,GAAGb,iBAAiB,GAA3B;AACA,MAAIc,SAAS,GAAGD,GAAG,CAACE,MAAJ,CAAWD,SAA3B;;AAEAN,EAAAA,YAAY,IAAZ,GAAiC,IAAjC;AACAA,EAAAA,YAAY,IAAZ,GAAkCR,iBAAiB,GAAnD;;AAEA,MAAII,gBAAgB,KAAK,KAArB,IAA8BS,GAAG,CAACE,MAAJ,CAAWC,iBAAX,KAAiC,IAAnE,EAAyE;AACvER,IAAAA,YAAY,IAAZ,IAAyBZ,6BAAzB;AACAY,IAAAA,YAAY,CAACG,IAAb,GAAoB,IAApB;AACAX,IAAAA,iBAAiB,GAAjB,GAAmC,KAAnC;AACD;;AAED,MAAI,CAACS,qBAAqB,IAAIC,iBAA1B,KAAgDR,GAAG,IAAI,IAA3D,EAAiE;AAC/DW,IAAAA,GAAG,CAACI,CAAJ;AACE;AACEH,IAAAA,SADF;AAEE,OAFF;AAGER,IAAAA,WAHF;AAIE,OAJF;AAKEH,IAAAA,iBAAiB,CAACI,EALpB;AAME,OANF;AAOEL,IAAAA,GAPF;AAQE,SATJ;;AAWD,GAZD,MAYO;AACLW,IAAAA,GAAG,CAACI,CAAJ,CAAM,SAASH,SAAT,GAAqB,GAArB,GAA2BR,WAA3B,GAAyC,KAA/C;AACD;;AAED,SAAOE,YAAP;AACD,CAlED","sourcesContent":["\"use strict\";\n\nconst ComponentDef = require(\"../ComponentDef\");\n\nvar FLAG_WILL_RERENDER_IN_BROWSER = 1;\n// var FLAG_HAS_RENDER_BODY = 2;\n\nmodule.exports = function beginComponent(\n  componentsContext,\n  component,\n  key,\n  ownerComponentDef,\n  isSplitComponent,\n  isImplicitComponent\n) {\n  var componentId = component.id;\n\n  var componentDef = (componentsContext.___componentDef = new ComponentDef(\n    component,\n    componentId,\n    componentsContext\n  ));\n\n  var ownerIsRenderBoundary =\n    ownerComponentDef && ownerComponentDef.___renderBoundary;\n  var ownerWillRerender =\n    ownerComponentDef &&\n    ownerComponentDef.___flags & FLAG_WILL_RERENDER_IN_BROWSER;\n  // On the server\n  if (!componentsContext.___isPreserved && ownerWillRerender) {\n    componentDef.___flags |= FLAG_WILL_RERENDER_IN_BROWSER;\n    componentDef._wrr = true;\n    return componentDef;\n  }\n\n  if (isImplicitComponent === true) {\n    // We don't mount implicit components rendered on the server\n    // unless the implicit component is nested within a UI component\n    // that will re-render in the browser\n    return componentDef;\n  }\n\n  componentsContext.___components.push(componentDef);\n\n  let out = componentsContext.___out;\n  let runtimeId = out.global.runtimeId;\n\n  componentDef.___renderBoundary = true;\n  componentDef.___parentPreserved = componentsContext.___isPreserved;\n\n  if (isSplitComponent === false && out.global.noBrowserRerender !== true) {\n    componentDef.___flags |= FLAG_WILL_RERENDER_IN_BROWSER;\n    componentDef._wrr = true;\n    componentsContext.___isPreserved = false;\n  }\n\n  if ((ownerIsRenderBoundary || ownerWillRerender) && key != null) {\n    out.w(\n      \"<!--\" +\n        runtimeId +\n        \"^\" +\n        componentId +\n        \" \" +\n        ownerComponentDef.id +\n        \" \" +\n        key +\n        \"-->\"\n    );\n  } else {\n    out.w(\"<!--\" + runtimeId + \"#\" + componentId + \"-->\");\n  }\n\n  return componentDef;\n};\n"],"file":"index.js"}